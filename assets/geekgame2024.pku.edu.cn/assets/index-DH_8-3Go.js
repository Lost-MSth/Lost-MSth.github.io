const __vite__fileDeps=["assets/Sakiko-BP-RC3j5.js","assets/vendor-RVuOwPKK.js","assets/TopStarPlot-DByRqPFr.js","assets/Table-DowCj0iQ.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{r as e,b as n,j as t,aJ as s,aK as r,aL as a,aM as l,aN as i,aO as o,aP as c,aQ as d,an as u,au as h,aR as m,aS as x,aT as p,av as j,a9 as g,aU as f,aV as b,aW as y,aX as w,aY as k,aZ as _,a_ as v,a$ as E,b0 as C,b1 as N,b2 as T,b3 as S,b4 as A,b5 as I,b6 as F,b7 as P,b8 as R,b9 as O,ba as D,bb as L,bc as M,bd as W,be as B,bf as z,bg as Y,S as H,bh as G,ao as Q,aH as J,bi as $,bj as U,bk as K,bl as q,bm as Z,bn as V,bo as X,bp as ee,bq as ne,br as te,bs as se,bt as re,bu as ae,al as le,bv as ie,bw as oe,bx as ce,by as de,bz as ue,bA as he,bB as me,bC as xe,bD as pe,bE as je,bF as ge,bG as fe,bH as be,bI as ye,bJ as we,ap as ke,bK as _e,bL as ve,bM as Ee,bN as Ce,bO as Ne,bP as Te,bQ as Se,bR as Ae,bS as Ie,bT as Fe,bU as Pe,a8 as Re,bV as Oe,bW as De,bX as Le,bY as Me,bZ as We}from"./vendor-RVuOwPKK.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&n(e)})).observe(document,{childList:!0,subtree:!0})}function n(e){if(e.ep)return;e.ep=!0;const n=function(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?n.credentials="include":"anonymous"===e.crossOrigin?n.credentials="omit":n.credentials="same-origin",n}(e);fetch(e.href,n)}}();var Be={exports:{}},ze={},Ye=e,He=Symbol.for("react.element"),Ge=Symbol.for("react.fragment"),Qe=Object.prototype.hasOwnProperty,Je=Ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$e={key:!0,ref:!0,__self:!0,__source:!0};function Ue(e,n,t){var s,r={},a=null,l=null;for(s in void 0!==t&&(a=""+t),void 0!==n.key&&(a=""+n.key),void 0!==n.ref&&(l=n.ref),n)Qe.call(n,s)&&!$e.hasOwnProperty(s)&&(r[s]=n[s]);if(e&&e.defaultProps)for(s in n=e.defaultProps)void 0===r[s]&&(r[s]=n[s]);return{$$typeof:He,type:e,key:a,ref:l,props:r,_owner:Je.current}}ze.Fragment=Ge,ze.jsx=Ue,ze.jsxs=Ue,Be.exports=ze;var Ke=Be.exports,qe={},Ze=n;qe.createRoot=Ze.createRoot,qe.hydrateRoot=Ze.hydrateRoot;var Ve=t(t({},s),{},{locale:"zh_CN",today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪",yearFormat:"YYYY年",cellDateFormat:"D",monthBeforeYear:!1});const Xe={placeholder:"请选择时间",rangePlaceholder:["开始时间","结束时间"]},en={lang:Object.assign({placeholder:"请选择日期",yearPlaceholder:"请选择年份",quarterPlaceholder:"请选择季度",monthPlaceholder:"请选择月份",weekPlaceholder:"请选择周",rangePlaceholder:["开始日期","结束日期"],rangeYearPlaceholder:["开始年份","结束年份"],rangeMonthPlaceholder:["开始月份","结束月份"],rangeQuarterPlaceholder:["开始季度","结束季度"],rangeWeekPlaceholder:["开始周","结束周"]},Ve),timePickerLocale:Object.assign({},Xe)};en.lang.ok="确定";const nn="${label}不是一个有效的${type}",tn={locale:"zh-cn",Pagination:r,DatePicker:en,TimePicker:Xe,Calendar:en,global:{placeholder:"请选择"},Table:{filterTitle:"筛选",filterConfirm:"确定",filterReset:"重置",filterEmptyText:"无筛选项",filterCheckall:"全选",filterSearchPlaceholder:"在筛选项中搜索",emptyText:"暂无数据",selectAll:"全选当页",selectInvert:"反选当页",selectNone:"清空所有",selectionAll:"全选所有",sortTitle:"排序",expand:"展开行",collapse:"关闭行",triggerDesc:"点击降序",triggerAsc:"点击升序",cancelSort:"取消排序"},Modal:{okText:"确定",cancelText:"取消",justOkText:"知道了"},Tour:{Next:"下一步",Previous:"上一步",Finish:"结束导览"},Popconfirm:{cancelText:"取消",okText:"确定"},Transfer:{titles:["",""],searchPlaceholder:"请输入搜索内容",itemUnit:"项",itemsUnit:"项",remove:"删除",selectCurrent:"全选当页",removeCurrent:"删除当页",selectAll:"全选所有",deselectAll:"取消全选",removeAll:"删除全部",selectInvert:"反选当页"},Upload:{uploading:"文件上传中",removeFile:"删除文件",uploadError:"上传错误",previewFile:"预览文件",downloadFile:"下载文件"},Empty:{description:"暂无数据"},Icon:{icon:"图标"},Text:{edit:"编辑",copy:"复制",copied:"复制成功",expand:"展开",collapse:"收起"},Form:{optional:"（可选）",defaultValidateMessages:{default:"字段验证错误${label}",required:"请输入${label}",enum:"${label}必须是其中一个[${enum}]",whitespace:"${label}不能为空字符",date:{format:"${label}日期格式无效",parse:"${label}不能转换为日期",invalid:"${label}是一个无效日期"},types:{string:nn,method:nn,array:nn,object:nn,number:nn,date:nn,boolean:nn,integer:nn,float:nn,regexp:nn,email:nn,url:nn,hex:nn},string:{len:"${label}须为${len}个字符",min:"${label}最少${min}个字符",max:"${label}最多${max}个字符",range:"${label}须在${min}-${max}字符之间"},number:{len:"${label}必须等于${len}",min:"${label}最小值为${min}",max:"${label}最大值为${max}",range:"${label}须在${min}-${max}之间"},array:{len:"须为${len}个${label}",min:"最少${min}个${label}",max:"最多${max}个${label}",range:"${label}数量须在${min}-${max}之间"},pattern:{mismatch:"${label}与模式不匹配${pattern}"}}},Image:{preview:"预览"},QRCode:{expired:"二维码过期",refresh:"点击刷新",scanned:"已扫描"},ColorPicker:{presetEmpty:"暂无"}};var sn={};function rn({text:e,width:n}){return Ke.jsx("span",{className:"capped-text",style:{maxWidth:n+"px"},children:e})}function an(e,n){n.loading({content:"正在前往登录页面…",key:"Utils.ToAuth",duration:15}),setTimeout((()=>{window.location.href=Zn+e}),100)}function ln(e){return e<10?"0"+e:e}function on(e,n=!0){let t=e instanceof Date?e:new Date(1e3*e);return n?`${ln(t.getMonth()+1)}-${ln(t.getDate())} ${ln(t.getHours())}:${ln(t.getMinutes())}:${ln(t.getSeconds())}`:`${ln(t.getMonth()+1)}-${ln(t.getDate())} ${ln(t.getHours())}:${ln(t.getMinutes())}`}!function(n){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){if("function"!=typeof WeakMap)return null;var n=new WeakMap,t=new WeakMap;return(s=function(e){return e?t:n})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return function(n,t,s,r,l,i){var o=i(),c=n,d=t;"week"!==d||e.week||e.weeks||(c=Math.round(Math.abs(r-o)/864e5),d="day");var u=a(c,o-r,null!=e.numbers?e.numbers:void 0),h=[];if("ago"===s&&e.prefixAgo&&h.push(u(e.prefixAgo)),"from now"===s&&e.prefixFromNow&&h.push(u(e.prefixFromNow)),c>1){var m=e[d+"s"]||e[d]||"%d "+d;h.push(u(m))}else{var x=e[d]||e[d+"s"]||"%d "+d;h.push(u(x))}"ago"===s&&e.suffixAgo&&h.push(u(e.suffixAgo)),"from now"===s&&e.suffixFromNow&&h.push(u(e.suffixFromNow));var p="string"==typeof e.wordSeparator?e.wordSeparator:" ";return h.join(p)}},function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==t(e)&&"function"!=typeof e)return{default:e};var n=s(void 0);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=a?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(r,l,i):r[l]=e[l]}r.default=e,n&&n.set(e,r)}(e);var r=function(e,n){return e&&10===e.length?String(n).split("").map((function(n){return n.match(/^[0-9]$/)?e[parseInt(n)]:n})).join(""):String(n)},a=function(e,n,t){return function(s){return"function"==typeof s?s(e,n).replace(/%d/g,r(t,e)):s.replace(/%d/g,r(t,e))}}}(sn);const cn=a(sn)({prefixAgo:null,prefixFromNow:"",suffixAgo:(e,n)=>n<59500?"刚刚":"前",suffixFromNow:(e,n)=>-n<59500?"1分钟之内":"后",seconds:"​",minute:"1分钟",minutes:"%d分钟",hour:"1小时",hours:"%d小时",day:"1天",days:"%d天",month:"1个月",months:"%d个月",year:"1年",years:"%d年",wordSeparator:""});function dn(e){return Ke.jsx(l,{...e,formatter:cn})}function un({ts:e,delta:n=0}){return Ke.jsx(dn,{date:1e3*(e+n),formatter:cn,title:on(e)})}function hn(){let e=i(),n=o();return Ke.jsx(c,{icon:Ke.jsx(d,{}),status:"error",title:"页面不存在",subTitle:Ke.jsx(rn,{text:e.pathname,width:300}),extra:[Ke.jsx(u,{onClick:()=>n("/"),children:"返回主页"},"home")]})}function mn({children:e,...n}){return Ke.jsx("a",{...n,target:"_blank",rel:"noopener noreferrer",children:e})}function xn(n,t,s){let r=Ct(),a=e.useRef(0),l=e.useRef(null);function i(e=!1){l.current&&(l.current.disabled=!0),a.current=+new Date,setTimeout((()=>{+new Date-a.current>=1e3*t-200&&l.current&&(l.current.disabled=!1)}),1e3*t),n(e)}return e.useEffect((()=>{a.current=+new Date}),[]),e.useEffect((()=>{function e(){r.feature.submit_flag&&+new Date-a.current>1e3*s&&i()}return window.addEventListener("focus",e),()=>{window.removeEventListener("focus",e)}})),[a.current/1e3,i,l]}function pn({children:e}){return Ke.jsxs(Ke.Fragment,{children:[e,Ke.jsx("span",{className:"nav-caret",children:Ke.jsx(h,{})})]})}function jn(e){return parseInt(e)}function gn(e){return parseFloat(e)}function fn(e,n){return"number"==typeof e&&isNaN(e)?n:e}const bn=2500,yn=10;let wn,kn;function _n(){const e=(function(){if(void 0!==kn)return;const e=()=>{const n=vn();En(n)?kn=setTimeout(e,bn):(wn=n,kn=void 0)};e()}(),async()=>{let e=vn();if(En(e)){if(wn)return[...wn];(function(){const e=document;return e.fullscreenElement||e.msFullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||null})()&&(await function(){const e=document;return(e.exitFullscreen||e.msExitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen).call(e)}(),e=vn())}return En(e)||(wn=e),e});return async()=>{const n=await e(),t=e=>null===e?null:function(e,n=1){if(Math.abs(n)>=1)return Math.round(e/n)*n;{const t=1/n;return Math.round(e*t)/t}}(e,yn);return[t(n[0]),t(n[1]),t(n[2]),t(n[3])]}}function vn(){const e=screen;return[fn(gn(e.availTop),null),fn(gn(e.width)-gn(e.availWidth)-fn(gn(e.availLeft),0),null),fn(gn(e.height)-gn(e.availHeight)-fn(gn(e.availTop),0),null),fn(gn(e.availLeft),null)]}function En(e){for(let n=0;n<4;++n)if(e[n])return!1;return!0}function Cn(){const e=screen,n=e=>fn(jn(e),null),t=[n(e.width),n(e.height)];return t.sort().reverse(),t}function Nn(){const e=navigator;let n,t=0;void 0!==e.maxTouchPoints?t=jn(e.maxTouchPoints):void 0!==e.msMaxTouchPoints&&(t=e.msMaxTouchPoints);try{document.createEvent("TouchEvent"),n=!0}catch{n=!1}return{maxTouchPoints:t,touchEvent:n,touchStart:"ontouchstart"in window}}function Tn(e){return matchMedia(`(dynamic-range: ${e})`).matches}function Sn(){var e;const n=null==(e=window.Intl)?void 0:e.DateTimeFormat;if(n){const e=(new n).resolvedOptions().timeZone;if(e)return e}const t=-function(){const e=(new Date).getFullYear();return Math.max(gn(new Date(e,0,1).getTimezoneOffset()),gn(new Date(e,6,1).getTimezoneOffset()))}();return`UTC${t>=0?"+":""}${Math.abs(t)}`}async function An(e){try{if("function"==typeof e)try{e=e()}catch(n){e="EXCEPTION-1 "+n}if(e&&e.then&&"function"==typeof e.then)try{e=await Promise.race([e,new Promise((e=>{setTimeout((()=>{e("TIMEOUT")}),7e3)}))])}catch(n){e="EXCEPTION-2 "+n}return void 0===e&&(e="<undefined>"),e}catch(n){return"EXCEPTION-3 "+n}}function In(){let e,n=document.createElement("canvas"),t=n.getContext("webgl")||n.getContext("experimental-webgl"),s=null,r=null;if(!navigator.userAgent.includes(" Firefox/")&&t.getSupportedExtensions().includes("WEBGL_debug_renderer_info")){e=!0;try{s=t.getParameter(t.getExtension("WEBGL_debug_renderer_info").UNMASKED_VENDOR_WEBGL)}catch(a){}try{r=t.getParameter(t.getExtension("WEBGL_debug_renderer_info").UNMASKED_RENDERER_WEBGL)}catch(a){}}else{e=!1;try{s=t.getParameter(t.VENDOR)}catch(a){}try{r=t.getParameter(t.RENDERER)}catch(a){}}return[s,r,e]}async function Fn(){if(navigator.getBattery){let e=await navigator.getBattery();return[e.charging,e.level]}return null}async function Pn(){return navigator.storage?await navigator.storage.estimate():null}async function Rn(){try{return await navigator.userAgentData.getHighEntropyValues(["architecture","bitness","model","platformVersion","fullVersionList"])}catch(e){return}}async function On(){return await new Promise((e=>{let n=[],t=!1,s={x:1},r=new(window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection)({iceServers:[{urls:["stun:stun.l.google.com:19302"]}]},{optional:[{RtpDataChannels:!0}]});r.onicecandidate=function(r){r.candidate&&function(r){let a=(/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{0,4}){2,7})/.exec(r)||[null,"x"])[1];void 0===s[a]&&n.push(a),s[a]=!0,setTimeout((()=>{t||(t=!0,e(n))}),300)}(r.candidate.candidate)},r.createDataChannel(""),r.createOffer((function(e){r.setLocalDescription(e,(function(){}),(function(){}))}),(function(){})),setTimeout((()=>{t||(t=!0,e(n))}),1e3)}))}const Dn="https://geekgame.pku.edu.cn/service/anticheat/report",Ln=2592e3,Mn="anticheat_canary",Wn="anticheat_canary_time",Bn=document.domain,zn=144e5;function Yn(e){document.cookie=`anticheat_canary=${e}; SameSite=None; Max-Age=${Ln}; Domain=${Bn}; Secure`}const Hn={},Gn=function(e,n,t){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),t=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));s=Promise.all(n.map((e=>{if((e=function(e){return"/"+e}(e))in Hn)return;Hn[e]=!0;const n=e.endsWith(".css"),s=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const r=document.createElement("link");return r.rel=n?"stylesheet":"modulepreload",n||(r.as="script",r.crossOrigin=""),r.href=e,t&&r.setAttribute("nonce",t),document.head.appendChild(r),n?new Promise(((n,t)=>{r.addEventListener("load",n),r.addEventListener("error",(()=>t(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}return s.then((()=>e())).catch((e=>{const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=e,window.dispatchEvent(n),!n.defaultPrevented)throw e}))},Qn=e.lazy((()=>Gn((()=>import("./Sakiko-BP-RC3j5.js")),__vite__mapDeps([0,1])))),Jn=!!window.documentPictureInPicture;function $n(){return Ke.jsx(x.ErrorBoundary,{children:Ke.jsx(e.Suspense,{fallback:Ke.jsx("div",{children:"加载中…"}),children:Ke.jsx(Qn,{})})})}function Un({button_visible:t,children:s,fallback:r}){let[a,l]=e.useState(null),{notification:i}=m.useApp();return e.useEffect((()=>{if(a){let e=function(){window.speechSynthesis.cancel(),window.gs_sakiko_win&&window.gs_sakiko_win.close()};return window.addEventListener("pagehide",e),()=>{window.removeEventListener("pagehide",e)}}}),[a]),Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("style",{children:'\n            body.miao>#root>.ant-app .header .header-nav .ant-menu-title-content::after,\n            body.miao>#root>.ant-app .header .header-logo>.clickable::after,\n            body.miao>#root>.ant-app .ant-btn::after,\n            body.miao>#root>.ant-app .announcement .ant-card-extra>a::after,\n            body.miao>#root>.ant-app .ant-tag::after,\n            body.miao>#root>.ant-app .portal-user-info-status::after,\n            body.miao>#root>.ant-app .portal-chall-header>*::after {\n                content: "喵";\n            }\n        '}),a?n.createPortal(Ke.jsx($n,{}),a):null,t?Ke.jsx("span",{onClick:async function(e){let n;if(e.preventDefault(),Jn)window.documentPictureInPicture.window&&window.documentPictureInPicture.window.close(),n=await window.documentPictureInPicture.requestWindow({width:240,height:360,disallowReturnToOpener:!0});else{window.gs_sakiko_win&&window.gs_sakiko_win.close();let e=window.screenX+window.outerWidth-240-50,t=window.screenY+window.outerHeight-360-120;n=window.open("","gs-sakiko",`width=240,height=360,screenX=${e},screenY=${t},popup`),n.document.title=document.title,window.gs_sakiko_win=n}n.onpagehide=()=>{n.close(),l(null)};let t=n.document.body;t.style.margin="0",l(t),i.success({key:"sakiko",className:"push-notif",icon:Ke.jsx(p,{}),message:"客服接通成功",description:"客服小祥竭诚为您服务"})},children:s}):r]})}const Kn="./service/",qn=Kn+"wish/",Zn=Kn+"auth/",Vn=Kn+"template/",Xn=Kn+"ws/",et=Kn+"anticheat/",nt=Kn+"attachment/",tt=document.title,st="133986617";function rt(e,n){return`https://${e.host}/?token=${n}`}const at=Ke.jsxs(Ke.Fragment,{children:[Ke.jsxs("p",{children:["比赛完全结束后，资料存档将公开到 GitHub。 本比赛的所有题面采用 ",Ke.jsx(mn,{href:"https://creativecommons.org/licenses/by-nc/4.0/",children:"CC BY-NC 4.0"})," 协议许可， 所有题目源码采用 ",Ke.jsx(mn,{href:"https://opensource.org/licenses/MIT",children:"MIT"})," 协议许可， 命题人和选手 Writeup 按照作者指定的方式进行许可。"]}),Ke.jsx("p",{children:"请注意上述许可不包括比赛相关的其他资料（包括但不限于比赛公告、参赛须知、比赛介绍和其他宣传资料）。这些资料不允许未授权使用。"})]}),lt=Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("p",{children:"请在 Writeup 中描述自己是如何解出每道题目的，其最低要求是让命题人相信你确实在比赛期间独立完成了题目。 借助生成式 AI 解题时，需提供完整聊天记录并保留服务端聊天记录备查。 建议使用 Markdown（.md）格式，但我们也接受 .pdf 等常见格式。"}),Ke.jsx("p",{children:"如果有附加文件（如截图和解题使用的脚本），请将 Writeup 和所有附加文件打包成 .7z 或 .zip 格式。 我们会将部分优秀选手 Writeup 公开到 GitHub，因此请注意控制文件大小，避免将题目附件、编译结果、临时文件、第三方程序打包在内。"}),Ke.jsx("p",{children:"在提交截止时间前请勿公开 Writeup 或交流思路。如果他人的 Writeup 与你雷同，你也会受到影响。"})]}),it="由于违反规则，此账号的参赛资格已被取消。如有疑问请联系工作人员。";let ot=!1;async function ct(){if(!ot){ot=!0;try{await async function(e=!1){let n=localStorage[Mn],t=parseInt(localStorage[Wn]),s=new Date-t;if(n?document.cookie.includes("anticheat_canary=")?(s>zn||s<-1e4)&&(e=!0):(Yn(n),e=!0):(n=function(){let e="";for(let n=0;n<10;n++)e+=String.fromCharCode(Math.floor(26*Math.random())+97);return e}(),Yn(n),e=!0),e){let e=await async function(){return{ua:await An(Rn()),webrtc_ip:await An(On()),screen_frame:await An(_n()),screen_resolution:await An(Cn()),touch_support:await An(Nn()),hdr:await An(!!Tn("high")||!Tn("standard")&&void 0),dpi:await An(window.devicePixelRatio),dark:window.matchMedia("(prefers-color-scheme: dark)").matches,tz:await An(Sn()),dnt:navigator.doNotTrack,webgl:await An(In()),cpus:navigator.hardwareConcurrency,memory:navigator.deviceMemory,battery:await An(Fn()),storage:await An(Pn())}}(),s=await fetch(Dn+(window._TABID?`?tabid=${window._TABID}`:""),{method:"GET",headers:{"Content-Type":"application/json"}});"OK"===await s.text()&&(localStorage[Mn]=n,localStorage[Wn]=+new Date)}}()}finally{ot=!1}}}const dt=Ke.jsx("img",{src:"data:image/webp;base64,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",alt:"",className:"game-logo"});function ut({cur_url:e}){let n=Ct(),t=n?n.user:null;return Ke.jsx(Un,{button_visible:null!==t&&"/license"===e,fallback:dt,children:Ke.jsx(j,{title:"联系客服",children:Ke.jsx("span",{style:{display:"inline-block",transform:"scale(2)",marginRight:"1rem",color:"#7799CC"},children:Ke.jsx(p,{})})})})}const ht="2024.v3",mt=function(){let e="";for(let n=0;n<4;n++)e+="qwertyuiopasdfghjkzxcvbnmQWERTYUPASDFGHJKLZXCVBNM23456789".charAt(Math.floor(57*Math.random()));return e}();function xt(e,n){return new Promise((t=>{fetch(qn+e+(e.includes("?")?"&":"?")+"tabid="+mt,{method:"GET",credentials:"include",headers:{"X-Wish-Version":ht,"Content-Type":"application/json"}}).then((e=>200!==e.status?{error:"HTTP_ERROR",error_msg:`HTTP 错误 ${e.status}`}:e.json())).then((e=>{t(e)})).catch((e=>{t({error:"HTTP_REQ_FAILED",error_msg:`网络错误 ${e}`})}))}))}function pt(n,t){let[s,r]=e.useState(null),[a,l]=e.useState(null),i=e.useCallback(((e=!0)=>{e&&(l(null),r(null)),xt(n,t).then((e=>{e.error?(r(e),l(null)):(r(null),l(e))}))}),[n,t]);return e.useEffect((()=>{i()}),[i]),[s,a,i]}function jt({height:e=400}){return Ke.jsx("div",{className:"loading-indicator",style:{height:e+"px",lineHeight:e+"px"},children:Ke.jsxs("p",{children:[Ke.jsx(g,{})," ","加载中"]})})}function gt(){return Ke.jsx("div",{children:Ke.jsx("div",{className:"header-container",children:Ke.jsx("div",{className:"header",children:Ke.jsxs("div",{className:"header-logo",children:[Ke.jsx(ut,{cur_url:"/"}),tt]})})})})}function ft({set_info:n}){let[t,s,r]=pt("game_info");e.useEffect((()=>{let e=+new Date;n(s?{...s,diag_ts:e-1e3*s.diag_ts}:null)}),[n,s]);let a=Ke.jsx(u,{type:"primary",onClick:r,children:"重试"},"refresh");return Ke.jsxs("div",{children:[Ke.jsx(gt,{}),Ke.jsx("div",{className:"main-container",children:t?"HTTP_REQ_FAILED"===t.error?Ke.jsx(c,{icon:Ke.jsx(f,{}),status:"error",title:"网络错误",subTitle:t.error_msg,extra:[a]}):"WISH_VERSION_MISMATCH"===t.error?Ke.jsx(c,{icon:Ke.jsx(b,{}),status:"error",title:"比赛平台更新",subTitle:t.error_msg,extra:[Ke.jsx(u,{type:"primary",onClick:function(){"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((e=>{for(let n of e)n.unregister()})),setTimeout((()=>{window.location.reload(!0)}),150)},children:"刷新页面"},"refresh")]}):Ke.jsx(c,{status:"error",title:"错误",subTitle:t.error_msg,extra:[a]}):Ke.jsx(jt,{height:500})})]})}function bt({message:e,reload:n}){return Ke.jsx(x,{type:"error",showIcon:!0,message:e,action:Ke.jsx(u,{onClick:n,children:"重试"})})}function yt(){return 200+1300*Math.random()}window._TABID=mt;const wt=localStorage.gs_push_debug||!1;class kt{constructor(e,n){this.app=n,this.ws=null,this.stopped=!1,this.count_reconnect=0,this.reload_info=e,setTimeout((()=>{this.connect()}),2e3)}handle_message(e){let n={key:"notification-"+ +new Date,className:"push-notif"};wt&&console.log("PushClient: handle message",e),"new_announcement"===e.type?this.app.notification.info({...n,icon:Ke.jsx(y,{}),message:"比赛公告",description:`有新的公告【${e.title}】`}):"tick_update"===e.type?setTimeout((()=>{this.app.notification.info({...n,icon:Ke.jsx(w,{}),message:"赛程提醒",description:e.new_tick_name.replace(/;/,"，")}),this.reload_info()}),yt()):"flag_first_blood"===e.type?this.app.notification.success({...n,icon:Ke.jsx(k,{}),message:"Flag 一血提醒",description:`恭喜【${e.nickname}】在【${e.board_name}】中拿到了题目【${e.challenge}】的【${e.flag}】的一血`}):"challenge_first_blood"===e.type?this.app.notification.success({...n,icon:Ke.jsx(k,{}),message:"题目一血提醒",description:`恭喜【${e.nickname}】在【${e.board_name}】中拿到了题目【${e.challenge}】的一血`}):"reload_user"===e.type&&setTimeout((()=>{this.reload_info()}),yt())}connect(){if(this.stopped)return;let e=new URL(Xn+"push?tabid="+mt,window.location.href);e.protocol="http:"===e.protocol?"ws:":"wss:",this.ws=new WebSocket(e.href),wt&&console.log("PushClient: connecting to",e.href);let n=null;this.ws.onopen=()=>{wt&&console.log("PushClient: socket opened"),n=setTimeout((()=>{this.count_reconnect=0}),25e3)},this.ws.onclose=e=>{4337===e.code&&(wt&&console.log("PushClient: socket closed by server, will not retry",e.reason),this.stopped=!0),this.stopped||(wt&&console.log("PushClient: socket closed, will reconnect later",e),setTimeout((()=>{this.count_reconnect<8?(this.count_reconnect++,this.connect()):(wt&&console.log("PushClient: stopped reconnecting"),this.app.message.error({content:"消息推送连接中断",key:"PushDaemon.Error",duration:3}))}),5e3),null!=n&&clearTimeout(n))},this.ws.onmessage=e=>{this.handle_message(JSON.parse(e.data))}}stop(){this.stopped=!0,null!==this.ws&&this.ws.close()}}function _t({info:n,reload_info:t}){let s=m.useApp();return e.useEffect((()=>{if(null!==n&&n.feature.push){let e=new kt(t,s);return window.addEventListener("pagehide",(n=>{wt&&console.log("PushClient: pagehide",n.persisted),e.stop()}),{capture:!0}),window.addEventListener("pageshow",(n=>{wt&&console.log("PushClient: pageshow",n.persisted),e.stop(),e=new kt(t,s)}),{capture:!0}),()=>{e.stop()}}}),[n,t]),null}let vt=e.createContext({info:{user:{id:null,login_key:"",group:"",group_disp:"",token:"",profile:{nickname:"",tel:"",email:"",stuid:"",qq:"",comment:""},terms_agreed:!1},feature:{push:!1,game:!1,submit_flag:!1,templates:[]},cur_tick:0,diag_ts:0},reload_info:()=>{}});function Et({children:n}){let[t,s]=e.useState(null);function r(){s(null)}return Ke.jsxs(vt.Provider,{value:{info:t,reload_info:r},children:[null!==t&&t.feature.push?Ke.jsx(_t,{info:t,reload_info:r}):null,null===t?Ke.jsx(ft,{set_info:s}):n]})}function Ct(){let{info:n}=e.useContext(vt);return n}function Nt(){return Ke.jsxs("div",{className:"slim-container",children:[Ke.jsx("h1",{children:"开源许可证"}),Ke.jsxs(_,{children:[Ke.jsx("p",{children:Ke.jsx("b",{children:"关于本平台的使用许可："})}),Ke.jsxs("p",{children:["Guiding Star 是为了 GeekGame 而开发的 CTF 比赛平台，",Ke.jsx(mn,{href:"https://github.com/PKU-GeekGame/guiding-star",children:"在 GitHub 开放源代码"}),"。"]}),Ke.jsx("p",{children:"允许任何人在 MIT 协议（如下）的要求下部署或二次开发本平台。"}),Ke.jsx("p",{children:"Copyright (c) @xmcp, and other members from PKUGGG Team"}),Ke.jsx("p",{children:'Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:'}),Ke.jsx("p",{children:"The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software."}),Ke.jsx("p",{children:'THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.'}),Ke.jsxs("p",{children:["平台前端部分使用了按照 MIT 协议开源的"," ",Ke.jsx(mn,{href:"https://github.com/facebook/react/blob/main/LICENSE",children:"React"}),"、",Ke.jsx(mn,{href:"https://github.com/remix-run/react-router/blob/main/LICENSE.md",children:"React-Router"}),"、",Ke.jsx(mn,{href:"https://github.com/nmn/react-timeago/blob/master/LICENSE",children:"React-TimeAgo"}),"、",Ke.jsx(mn,{href:"https://github.com/ant-design/ant-design/blob/master/LICENSE",children:"Ant-Design"}),"、",Ke.jsx(mn,{href:"https://github.com/ant-design/ant-design-charts/blob/master/LICENSE",children:"Ant-Design-Charts"})," 和"," ",Ke.jsx(mn,{href:"https://github.com/sudodoki/copy-to-clipboard/blob/master/LICENSE",children:"copy-to-clipboard"})," ","等第三方组件。"]}),Ke.jsx("p",{children:"平台后端部分使用的第三方组件列表参见后端代码。"})]}),Ke.jsx("br",{}),Ke.jsxs(_,{children:[Ke.jsx("p",{children:Ke.jsx("b",{children:"关于比赛内容的使用许可："})}),at]})]})}function Tt(e){let n=e.split("-");return 2===n.length?[n[0],"deducted"===n[1]]:[e,!1]}const St=e.memo((function({status:e}){let n,[t,s]=Tt(e);return n="untouched"===t?Ke.jsx(v,{className:"challenge-icon-untouched"}):"partial"===t?Ke.jsx(E,{className:"challenge-icon-partial",twoToneColor:"#1e63bd"}):"passed"===t?Ke.jsx(C,{className:"challenge-icon-passed",twoToneColor:"#1ab500"}):"??",s?Ke.jsx("span",{className:"status-icon-deducted",children:n}):n})),At=e.memo((function({status:e}){let n,[t,s]=Tt(e);return n="untouched"===t?Ke.jsx(N,{className:"flag-icon-passed",twoToneColor:"#a7a7a7"}):"passed"===t?Ke.jsx(N,{className:"flag-icon-passed",twoToneColor:"#1ab500"}):"??",s?Ke.jsx("span",{className:"status-icon-deducted",children:n}):n}));function It({color:e,children:n}){return null===n?null:Ke.jsx("span",{className:"category-badge",children:Ke.jsx(T,{color:e,children:n})})}function Ft({badges:e}){if(0===e.length)return null;let n=[];for(let t of e)"rookie"===t?n.push(Ke.jsx(j,{destroyTooltipOnHide:!0,title:"具有新生特别奖资格",children:Ke.jsx(A,{})},t)):"thanks"===t?n.push(Ke.jsx(j,{destroyTooltipOnHide:!0,title:"崇高道德的赞许",children:Ke.jsx(I,{twoToneColor:"#ff0000"})},t)):t.startsWith("remark:")?n.push(Ke.jsx(j,{destroyTooltipOnHide:!0,title:t.substring(7),children:Ke.jsx(S,{twoToneColor:"#ff6600"})},t)):n.push(Ke.jsxs("span",{children:["[",t,"]"]},t));return Ke.jsx("span",{className:"user-badges",children:n})}function Pt({name:e}){let n=e.indexOf(" #");if(n<=0)return Ke.jsx("span",{className:"name-base-part",children:e});{let t=e.substring(0,n),s=e.substring(n);return Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("span",{className:"name-base-part",children:t}),Ke.jsx("span",{className:"name-tag-part",children:s})]})}}function Rt({children:e}){return Ke.jsx(T,{color:"blue",className:"user-group-tag",children:e})}const Ot=()=>Gn((()=>import("./TopStarPlot-DByRqPFr.js")),__vite__mapDeps([2,1])),Dt=e.lazy(Ot);function Lt({plotkey:n,data:t,single:s}){return Ke.jsx(x.ErrorBoundary,{children:Ke.jsx(e.Suspense,{fallback:Ke.jsx(jt,{height:s?125:350}),children:Ke.jsx(Dt,{data:t,single:s},n)})})}const Mt=()=>Gn((()=>import("./Table-DowCj0iQ.js")),__vite__mapDeps([3,1])),Wt=e.lazy(Mt),Bt=e.lazy((async()=>(await Gn((async()=>{const{Column:e}=await import("./Table-DowCj0iQ.js");return{Column:e}}),__vite__mapDeps([3,1]))).Column));function zt(n){return Ke.jsx(x.ErrorBoundary,{children:Ke.jsx(e.Suspense,{fallback:Ke.jsx(jt,{height:350}),children:Ke.jsx(Wt,{...n})})})}function Yt({others_uid:e}){let[n,t,s]=pt(null!==e?"submissions/"+e:"my_submissions");return n?Ke.jsx(bt,{message:n.error_msg,reload:s}):null===t?Ke.jsx(jt,{}):Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(Lt,{plotkey:null,data:t,single:!0}),Ke.jsx("br",{}),Ke.jsxs(zt,{size:"small",dataSource:t.list,rowKey:"idx",scroll:{x:"max-content"},children:[Ke.jsx(zt.Column,{title:"提交时间",dataIndex:"timestamp_s",render:e=>on(e)}),Ke.jsx(zt.Column,{title:"题目",render:(e,n)=>Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(It,{color:n.category_color,children:n.category}),n.challenge_title]})},"challenge_title"),Ke.jsx(zt.Column,{title:"Flag",dataIndex:"matched_flag",render:e=>null===e?Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(At,{status:"untouched"})," 不正确"]}):Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(At,{status:"passed"})," ",e||"Flag"]})}),null===e&&Ke.jsx(zt.Column,{title:"备注",dataIndex:"overrides",render:e=>e.map(((e,n)=>Ke.jsx(T,{color:"red",children:e},n)))}),Ke.jsx(zt.Column,{title:"得分",dataIndex:"gained_score"})]})]})}function Ht(){return Ke.jsxs("div",{className:"slim-container",children:[Ke.jsx("h1",{children:"提交历史记录"}),Ke.jsx(Yt,{others_uid:null})]})}function Gt({children:n,nickname:t,uid:s}){let[r,a]=e.useState(0),l=Ke.jsxs("a",{className:"looking-glass-link",onClick:()=>a(1),children:[n," ",Ke.jsx(P,{})]});return 0===r?l:Ke.jsxs(Ke.Fragment,{children:[l,Ke.jsx(F,{title:`${t}（#${s}）的得分记录`,open:1===r,onCancel:()=>a(2),footer:null,destroyOnClose:!0,width:700,children:Ke.jsx(Yt,{others_uid:s})})]})}function Qt({ch:e,record:n}){return Ke.jsxs("div",{children:[Ke.jsxs("p",{children:[Ke.jsx("b",{children:e.title})," (",e.category,")"]}),e.flags.map(((t,s)=>{let r=n.flag_status[`${e.key}_${s}`]||null;return Ke.jsxs("p",{children:[Ke.jsx(At,{status:null===r?"untouched":"passed"})," ",t,"：",null===r?"尚未通过":`(+${r[1]}) ${on(r[0])}`]},s)}))]})}function Jt({ch:n,record:t,marginLeft:s}){let[r,a]=e.useState(0),l=Ke.jsx("span",{className:"board-challenge-status-icon"+(s?" board-challenge-status-marginleft":""),children:Ke.jsx(St,{status:t.challenge_status[n.key]||"untouched"})});return Ke.jsx("span",{onMouseEnter:()=>a(1),onMouseLeave:()=>a(2),children:0===r?l:Ke.jsx(j,{title:Ke.jsx(Qt,{ch:n,record:t}),placement:"topRight",align:{offset:[9,-1]},open:1===r,trigger:[],overlayClassName:"board-challenge-status-tooltip",autoAdjustOverflow:!1,destroyTooltipOnHide:!0,children:l})})}function $t({challenges:e,record:n}){return e.map(((t,s)=>Ke.jsx(Jt,{ch:t,record:n,marginLeft:s>0&&t.category!==e[s-1].category},t.key)))}function Ut({data:n,last_reloaded:t}){let s=Ct(),r=null!==s.user?s.user.id:null,a=1.1*n.challenges.length;for(let e=1;e<n.challenges.length;e++)n.challenges[e].category!==n.challenges[e-1].category&&(a+=.55);let l=Ke.jsx("div",{style:{height:"1.5em",width:1.5*a+"em",backgroundColor:"#eee"}});return e.useEffect((()=>{D()}),[n]),Ke.jsxs("div",{className:"scoreboard",children:[Ke.jsx(Lt,{plotkey:t,data:n,single:!1}),Ke.jsx("br",{}),Ke.jsxs(zt,{size:"small",dataSource:n.list,pagination:!1,rowKey:"rank",scroll:{x:"max-content"},onRow:e=>r&&e.uid===r?{className:"active-bg-row"}:{},sticky:!0,children:[Ke.jsx(zt.Column,{title:"#",dataIndex:"rank",align:"right"}),Ke.jsx(zt.Column,{title:"昵称",className:"board-col-bold",render:(e,n)=>Ke.jsxs(L,{once:!0,offset:150,placeholder:n.nickname,children:[Ke.jsx(Pt,{name:n.nickname}),null===n.group_disp?null:Ke.jsxs(Ke.Fragment,{children:[" ",Ke.jsx(Rt,{children:n.group_disp})]}),Ke.jsx(Ft,{badges:n.badges})]})},"name"),Ke.jsx(zt.Column,{title:"总分",dataIndex:"score",className:"board-col-bold",render:(e,n)=>Ke.jsx(Gt,{uid:n.uid,nickname:n.nickname,children:e})}),Ke.jsx(zt.Column,{title:"最后提交时间",dataIndex:"last_succ_submission_ts",render:e=>on(e)}),Ke.jsx(zt.Column,{title:"答题进度",render:(e,t)=>Ke.jsx(L,{once:!0,offset:150,placeholder:l,children:Ke.jsx($t,{record:t,challenges:n.challenges})})},"challenges")]})]})}function Kt({data:e}){let n=Ct(),t=null!==n.user?n.user.id:null,s=e.list.flatMap((e=>e.flags.map(((n,t)=>({...n,challenge_title:e.title,challenge_metadata:e.metadata,challenge_category:e.category,challenge_category_color:e.category_color,flags_count:e.flags.length,flag_idx0:t,key:`${e.key}_${t}`}))))),r=Ke.jsx("span",{style:{display:"inline-block",width:"5em"}});return Ke.jsxs(zt,{size:"small",dataSource:s,pagination:!1,rowKey:"key",scroll:{x:"max-content"},onRow:e=>t&&e.uid===t?{className:"active-bg-row"}:{},sticky:!0,children:[Ke.jsx(zt.Column,{title:"题目 ",dataIndex:"challenge_title",align:"right",onCell:e=>({rowSpan:0===e.flag_idx0?e.flags_count:0}),render:(e,n)=>Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(It,{color:n.challenge_category_color,children:n.challenge_category}),Ke.jsxs("b",{children:[e," "]})]})}),Ke.jsx(zt.Column,{title:"Flag",dataIndex:"flag_name",render:(e,n)=>Ke.jsxs(Ke.Fragment,{children:[null===e?n.flags_count>1?"解出所有 Flag":"解出 Flag":Ke.jsxs(Ke.Fragment,{children:[" > ",e]}),!(null!==e||!n.challenge_metadata.first_blood_award_eligible)&&Ke.jsxs(j,{title:"首个完全解出的校内选手可获得此题的解题先锋奖",children:[" ",Ke.jsxs(T,{color:"#a00",children:[Ke.jsx(M,{twoToneColor:"red"})," 解题先锋奖"]})]})]})}),Ke.jsx(zt.Column,{title:"一血获得者",render:(e,n)=>null===n.nickname?r:Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(Pt,{name:n.nickname}),null===n.group_disp?null:Ke.jsxs(Ke.Fragment,{children:[" ",Ke.jsx(Rt,{children:n.group_disp})]}),Ke.jsx(Ft,{badges:n.badges})]})},"user"),Ke.jsx(zt.Column,{title:"提交时间",dataIndex:"timestamp",render:(e,n)=>null===e?r:Ke.jsx(Gt,{uid:n.uid,nickname:n.nickname,children:Ke.jsx("span",{style:{fontWeight:"normal"},children:on(e)})})})]})}function qt({data:e,last_reloaded:n}){return"score"===e.type?Ke.jsx(Ut,{data:e,last_reloaded:n}):"firstblood"===e.type?Ke.jsx(Kt,{data:e,last_reloaded:n}):Ke.jsx(x,{type:"error",message:`未知排行榜类型 ${e.type}`,showIcon:!0})}zt.Column=Bt;const Zt=e.memo((function({name:e}){let[n,t,s]=pt("board/"+e),[r,a,l]=xn(s,3,180),{message:i}=m.useApp();return n?Ke.jsx(bt,{message:n.error_msg,reload:()=>{a()}}):Ke.jsxs("div",{children:[Ke.jsxs("div",{className:"board-reloader",children:[Ke.jsxs("div",{children:[Ke.jsx(R,{})," ",0!==r&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(un,{ts:r}),"更新（",on(r),"）"]})]}),Ke.jsx("div",{children:Ke.jsxs(u,{type:"link",ref:l,onClick:()=>{i.success({content:"已刷新排行榜",key:"Board.ManualLoadData",duration:2}),a()},children:[Ke.jsx(O,{})," 刷新排行榜"]})})]}),null===t?Ke.jsx(jt,{}):Ke.jsxs("div",{children:[!!t.desc&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(x,{type:"info",message:t.desc,showIcon:!0}),Ke.jsx("br",{})]}),Ke.jsx(qt,{data:t,last_reloaded:r})]})]})}));function Vt(){let[n,t,s]=pt("writeup"),{message:r}=m.useApp(),[a,l]=e.useState(!1),[i,o]=e.useState(null),[c,d]=e.useState("Maybe"),[h,p]=e.useState("CC-BY-NC");return n?Ke.jsx(bt,{message:n.error_msg,reload:s}):null===t?Ke.jsx(jt,{}):Ke.jsxs("div",{children:[t.writeup_required?Ke.jsx(x,{showIcon:!0,type:"info",message:Ke.jsxs(Ke.Fragment,{children:["按照比赛规则，你 ",Ke.jsx("b",{children:"需要"})," 在截止时间前提交 Writeup"]})}):Ke.jsx(x,{showIcon:!0,type:"info",message:Ke.jsxs(Ke.Fragment,{children:["按照比赛规则，你 ",Ke.jsx("b",{children:"不需要"})," 提交 Writeup，但在截止时间前可以自愿提交"]})}),Ke.jsx("br",{}),t.submitted_metadata?Ke.jsx(x,{showIcon:!0,type:"success",message:"已经提交了 Writeup",description:Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("ul",{children:Object.keys(t.submitted_metadata).map((e=>Ke.jsxs("li",{children:[e,": ",t.submitted_metadata[e]]},e)))}),Ke.jsx("p",{children:"在截止时间前，你可以提交新的 Writeup 来覆盖上述内容"})]})}):Ke.jsx(x,{showIcon:!0,type:"info",message:"尚未提交 Writeup"}),Ke.jsx("br",{}),lt,Ke.jsx("br",{}),Ke.jsx(_,{title:"提交新的 Writeup",size:"small",type:"inner",bordered:!1,children:Ke.jsxs(W,{onFinish:function(){if(!i)return void r.error({content:"请上传 Writeup 文件",key:"Writeup.Submit",duration:3});let e=new FormData;e.append("file",i),e.append("publish",c),e.append("rights",h),l(!0);const n=new XMLHttpRequest;n.open("PUT",qn+"writeup"),n.setRequestHeader("X-Wish-Version",ht),n.withCredentials=!0,n.responseType="json",n.upload.addEventListener("progress",(e=>{if(e.lengthComputable){let n=(100*e.loaded/e.total).toFixed(1);r.loading({content:`正在上传…（${n}%）`,key:"Writeup.Submit",duration:20})}})),n.addEventListener("loadend",(()=>{4!==n.readyState?r.error({content:`网络错误 state=${n.readyState}`,key:"Writeup.Submit",duration:3}):200!==n.status?r.error({content:`HTTP 错误 ${n.status}`,key:"Writeup.Submit",duration:3}):n.response.error?r.error({content:n.response.error_msg,key:"Writeup.Submit",duration:3}):(r.success({content:"提交成功",key:"Writeup.Submit",duration:2}),o(null),s()),l(!1)})),n.send(e)},colon:!1,labelCol:{span:4},labelWrap:!0,wrapperCol:{span:20},children:[Ke.jsx(W.Item,{label:"上传文件",children:Ke.jsxs(B.Dragger,{fileList:[],beforeUpload:e=>(e.size/1024/1024<t.max_size_mb?o(e):r.error({content:"文件过大，请删除不必要的内容或者压缩图片",key:"Writeup.File",duration:3}),!1),disabled:a,children:[Ke.jsx("p",{className:"ant-upload-drag-icon",children:i?Ke.jsx(z,{}):Ke.jsx(Y,{})}),Ke.jsx("p",{className:"ant-upload-text",children:i?i.name:"选择文件或者拖拽到此处"}),Ke.jsx("p",{className:"ant-upload-hint",children:i?Ke.jsxs(Ke.Fragment,{children:[(i.size/1024/1024).toFixed(2),"MB"]}):Ke.jsxs(Ke.Fragment,{children:["文件格式：建议使用 .md, .pdf, .pptx, .7z, .zip 之一",Ke.jsx("br",{}),"文件大小：上限 ",t.max_size_mb,"MB，但一个正常的 Writeup 应当 ",Ke.jsx("b",{children:"远小于"})," 此大小"]})})]})}),Ke.jsx(W.Item,{label:"是否公开",help:"Always-Yes"===c?Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("b",{children:"此 Writeup 的内容将在赛后公开"}),"，用于学习交流"]}):"Maybe"===c?Ke.jsxs(Ke.Fragment,{children:["赛后将公开一些高质量或者含有特殊解法的选手 Writeup 用于学习交流，",Ke.jsx("b",{children:"你将允许我们酌情公开或者不公开此 Writeup 的内容"})]}):"Always-No"===c?Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("b",{children:"此 Writeup 的内容将不会被公开给其他选手"}),"，但命题人依然会出于反作弊目的检查此 Writeup"]}):Ke.jsxs(Ke.Fragment,{children:["(",c,")"]}),children:Ke.jsxs(H.Group,{buttonStyle:"solid",value:c,onChange:e=>d(e.target.value),disabled:a,children:[Ke.jsx(H.Button,{value:"Always-Yes",children:"始终公开"}),Ke.jsx(H.Button,{value:"Maybe",children:"可以公开（默认）"}),Ke.jsx(H.Button,{value:"Always-No",children:"不公开"})]})}),Ke.jsx(W.Item,{label:"权利",help:"All-Rights-Reserved"===h?Ke.jsxs(Ke.Fragment,{children:["除非你明确允许，读者 ",Ke.jsx("b",{children:"不得转载或改编"})," 此 Writeup 的内容"]}):"CC-BY-NC"===h?Ke.jsxs(Ke.Fragment,{children:["此 Writeup 将按照 ",Ke.jsx(mn,{href:"https://creativecommons.org/licenses/by-nc/4.0/",children:"CC BY-NC 4.0"})," ","协议允许读者 ",Ke.jsx("b",{children:"在注明出处的情况下非商业使用"})," 其中的内容"]}):"CC0"===h?Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("b",{children:"你将放弃对此 Writeup 的所有权利"}),"， 按照 ",Ke.jsx(mn,{href:"https://creativecommons.org/publicdomain/zero/1.0/",children:"CC0 1.0"})," ","协议允许读者任意使用其中的内容"]}):Ke.jsxs(Ke.Fragment,{children:["(",h,")"]}),children:Ke.jsxs(H.Group,{buttonStyle:"solid",value:h,onChange:e=>p(e.target.value),disabled:a,children:[Ke.jsx(H.Button,{value:"All-Rights-Reserved",children:"保留所有权利"}),Ke.jsx(H.Button,{value:"CC-BY-NC",children:"允许非商业使用"}),Ke.jsx(H.Button,{value:"CC0",children:"允许任意使用"})]})}),Ke.jsxs(u,{block:!0,type:"primary",size:"large",htmlType:"submit",disabled:a||null===i,children:[Ke.jsx(G,{})," 提交"]})]})})]})}function Xt(){return Ke.jsxs("div",{className:"slim-container writeup-container",children:[Ke.jsx("h1",{children:"提交 Writeup"}),Ke.jsx(Vt,{})]})}function es({name:e,children:n}){return Ke.jsx("div",{className:`template template-${e}`,dangerouslySetInnerHTML:{__html:n}})}function ns({name:n}){let[t,s]=e.useState(null),[r,a]=e.useState(null),l=e.useCallback((()=>{a(null),s(null),fetch(Vn+n,{method:"GET",credentials:"include"}).then((e=>200!==e.status?(s(`HTTP 错误 ${e.status}`),null):e.text())).then((e=>{a(e)})).catch((e=>{s(`网络错误 ${e}`)}))}),[n]);return e.useEffect((()=>{l()}),[l]),t?Ke.jsx(bt,{message:t,reload:l}):null===r?Ke.jsx(jt,{}):Ke.jsx(es,{name:n,children:r})}const ts=10;function ss({announcement:e,extra:n}){return Ke.jsx("div",{className:"announcement",children:Ke.jsx(_,{type:"inner",size:"small",bordered:!1,extra:n||null,title:Ke.jsxs(Ke.Fragment,{children:[Ke.jsxs(T,{style:{fontSize:"1em",fontWeight:"bold"},color:"#555",children:[Ke.jsx(y,{})," ",e.title]})," ",Ke.jsx(un,{ts:e.timestamp_s}),"发布"]}),children:Ke.jsx(es,{name:"announcement",children:e.content})})})}function rs(){let[n,t,s]=pt("announcements"),[r,a]=e.useState(1);if(e.useEffect((()=>{window.scroll(0,0)}),[r]),n)return Ke.jsx(bt,{message:n.error_msg,reload:s});if(null===t)return Ke.jsx(jt,{});if(0===t.list.length)return Ke.jsx(Q,{image:Q.PRESENTED_IMAGE_SIMPLE,description:"暂无公告"});let l=t.list.slice((r-1)*ts,r*ts);return Ke.jsxs("div",{className:"announcement-list",children:[l.map((e=>Ke.jsx(ss,{announcement:e},e.id))),Ke.jsx(J,{align:"center",current:r,onChange:e=>a(e),total:t.list.length,pageSize:ts})]})}function as({cur:n,children:t,skipexit:s=!1}){let r=e.useRef();return Ke.jsx($,{children:Ke.jsx(U,{classNames:"app-transition",timeout:{enter:100,exit:s?0:100},nodeRef:r,unmountOnExit:!0,children:Ke.jsxs("div",{className:"comment",ref:r,children:[" ",t]})},n)})}function ls(){let e=Ct(),{message:n}=m.useApp();return Ke.jsxs("div",{className:"token-widget",children:[Ke.jsxs(u,{onClick:function(){q(e.user.token)&&n.success({content:"已复制",key:"TokenWidget",duration:2})},size:"small",children:[Ke.jsx(K,{})," 复制个人Token"]}),Ke.jsx("span",{children:"部分题目需要输入个人 Token 来验证身份，与他人分享 Token 将视为作弊。"})]})}function is(){let{message:e}=m.useApp();return Ke.jsx("div",{className:"landing-login-form",children:Ke.jsxs(_,{type:"inner",size:"small",bordered:!1,children:[Ke.jsx("b",{children:"报名参赛："}),Ke.jsxs(u,{type:"primary",onClick:()=>an("pku/redirect",e),children:[Ke.jsx(Z,{})," 北京大学登录"]})," ",Ke.jsxs(u,{type:"primary",onClick:()=>an("carsi/login",e),children:[Ke.jsx(Z,{})," 清华大学登录"]})," ",Ke.jsxs(u,{onClick:()=>window.location.href="#/login/other",children:[Ke.jsx(V,{})," 校外选手"]})]})})}function os({action:e,ch:n}){let t=Ct(),{message:s}=m.useApp();function r(){fetch(`${et}event?name=visit_action&tabid=${mt}`,{method:"GET",credentials:"include",priority:"low",headers:{"Content-Type":"application/json"}})}if("webpage"===e.type)return Ke.jsxs(Ke.Fragment,{children:["你可以 ",Ke.jsxs(mn,{onPointerDown:r,href:e.url.replace(/\{\{token}}/g,t.user.token),children:["访问",e.name]})]});if("webdocker"===e.type)return Ke.jsxs(Ke.Fragment,{children:["你可以 ",Ke.jsxs(mn,{onPointerDown:r,href:`https://${e.host}/docker-manager/start?${t.user.token}`,children:["访问",e.name]})," ",Ke.jsx(pe,{trigger:"click",content:Ke.jsxs("div",{children:[Ke.jsxs("p",{children:["本题为每名选手分配一个独立的后端环境，参见 ",Ke.jsx("a",{href:"#/info/faq",children:"FAQ：关于 Web 题目环境"})]}),Ke.jsx("p",{children:"如果题目出现问题可以手动关闭环境，下次访问时将启动新的环境"}),Ke.jsx(u,{block:!0,danger:!0,onClick:()=>{window.open(`https://${e.host}/docker-manager/stop?${t.user.token}`)},children:"关闭环境"})]}),children:Ke.jsxs(u,{size:"small",className:"challenge-action-auxbtn",children:[Ke.jsx(je,{}),"环境控制"]})})]});if("terminal"===e.type)return Ke.jsxs(Ke.Fragment,{children:["你可以 ",Ke.jsx(mn,{onPointerDown:r,href:rt(e,t.user.token),children:"打开网页终端"})," 或者通过命令"," ",Ke.jsxs("code",{children:["nc ",e.host," ",e.port]})," 连接到",e.name]});if("attachment"===e.type){let r=`${nt}${n.key}/${e.filename}?token=${t.user.token}`;return Ke.jsxs(Ke.Fragment,{children:["你可以 ",Ke.jsxs(mn,{href:r,children:["下载",e.name]})," ",Ke.jsx(pe,{trigger:"click",content:Ke.jsxs("div",{children:[Ke.jsx("p",{children:"可以在未登录比赛平台的设备上通过链接下载附件"}),Ke.jsx("p",{children:"下载链接包含你的个人 Token，与他人分享将视为作弊"}),Ke.jsx(u,{block:!0,onClick:()=>{q(new URL(r,location.href).href)&&s.success({content:"已复制",key:"ChallengeActionAttachment",duration:2})},children:"复制下载链接"})]}),children:Ke.jsxs(u,{size:"small",className:"challenge-action-auxbtn",children:[Ke.jsx(K,{}),"复制链接"]})})]})}}function cs({ch:e}){let n=Ct(),[t,s,r]=pt("get_touched_users/"+e.key),a=null!==n.user?n.user.id:null;return t?Ke.jsx(bt,{message:t.error_msg,reload:r}):s?Ke.jsx("div",{children:Ke.jsxs(zt,{dataSource:s.list,size:"small",rowKey:"uid",onRow:e=>e.uid===a?{className:"active-bg-row"}:{},children:[Ke.jsx(zt.Column,{title:"昵称",render:(e,n)=>Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(Pt,{name:n.nickname})," ",Ke.jsx(Rt,{children:n.group_disp}),Ke.jsx(Ft,{badges:n.badges})]}),filters:[{text:"北京大学选手",value:"pku"},{text:"清华大学选手",value:"thu"},{text:"其他选手",value:"other"}],onFilter:(e,n)=>0===e.uid||("pku"===e?"北京大学"===n.group_disp:"thu"===e?"清华大学"===n.group_disp:"other"!==e||"北京大学"!==n.group_disp&&"清华大学"!==n.group_disp),filterMultiple:!1},"user"),Ke.jsx(zt.Column,{title:"总分",dataIndex:"tot_score",render:(e,n)=>n.uid?Ke.jsx(Gt,{uid:n.uid,nickname:n.nickname,children:e}):null},"tot_score"),e.flags.map(((e,n)=>Ke.jsx(zt.Column,{title:e.name||"通过本题时间",dataIndex:["flags",n],render:e=>e?on(e):""},n)))]})}):Ke.jsx(jt,{height:350})}function ds({do_reload_list:n,ch:t}){let[s,r]=e.useState(!1),[a,l]=e.useState(""),{message:i}=m.useApp();return Ke.jsx("div",{children:Ke.jsx(le.Search,{value:a,onChange:e=>l(e.target.value),size:"large",addonBefore:t.flags.length>1?Ke.jsxs(j,{title:`此题有 ${t.flags.length} 个 Flag，系统会识别你提交的是哪一个`,children:["提交任意 Flag：",Ke.jsx(ie,{})]}):"提交 Flag：",placeholder:"flag{...}",enterButton:Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(oe,{})," 提交"]}),onSearch:function(){a&&(i.loading({content:"正在提交…",key:"FlagInput",duration:10}),r(!0),xt("submit_flag",{challenge_key:t.key,flag:a}).then((e=>{r(!1),l(""),e.error?i.error({content:e.error_msg,key:"FlagInput",duration:3}):(i.success({content:"Flag正确",key:"FlagInput",duration:2}),n())})))},loading:s})})}function us({ch:e}){let[n,t,s]=pt("challenge/"+e.key);return n?Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(bt,{message:n.error_msg,reload:s}),Ke.jsx("br",{})]}):null===t?Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(jt,{}),Ke.jsx("br",{})]}):Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(es,{name:"challenge-desc",children:t.desc}),Ke.jsx("br",{}),t.actions.map(((n,t)=>Ke.jsxs("p",{className:"challenge-action",children:[Ke.jsx(te,{})," ",Ke.jsx(os,{ch:e,action:n})]},t)))]})}function hs({ch:n}){let[t,s]=e.useState("notice"),[r,a]=e.useState(""),{message:l}=m.useApp();return ce({message:"反馈尚未提交，确定要离开吗？",when:()=>"draft"===t&&r}),Ke.jsx("div",{className:"feedback-form",children:"notice"===t?Ke.jsxs(Ke.Fragment,{children:[Ke.jsxs("ul",{children:[Ke.jsxs("li",{children:["使用此功能来",Ke.jsx("b",{children:"单方面反馈题目中的问题"}),"，例如存在非预期解、题目环境与附件不符、题目描述具有误导性。"]}),Ke.jsxs("li",{children:["出题人",Ke.jsx("b",{children:"不会单独回复反馈"}),"，但可能依据反馈内容来修复题目问题、发布补充说明或者撰写第二阶段提示。"]}),Ke.jsxs("li",{children:["如果希望咨询出题人并获得回复，请",Ke.jsx("b",{children:"在选手群联系管理员"}),"，而非提交反馈。"]}),Ke.jsxs("li",{children:["请注意",Ke.jsx("b",{children:"每小时只能提交一次反馈"}),"。"]})]}),Ke.jsxs(u,{block:!0,type:"primary",onClick:()=>s("draft"),children:[Ke.jsx(de,{})," 反馈问题"]})]}):Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("div",{children:Ke.jsx(le.TextArea,{value:r,onChange:e=>a(e.target.value),placeholder:"（反馈内容……）",disabled:"draft"!==t,maxLength:1200,showCount:!0,autoSize:{minRows:5,maxRows:10}})}),Ke.jsx("br",{}),Ke.jsx(ue,{title:Ke.jsxs(Ke.Fragment,{children:["请注意",Ke.jsx("b",{children:"出题人不会单独回复反馈"}),"，",Ke.jsx("br",{}),"而且",Ke.jsx("b",{children:"每小时只能提交一次"}),"。"]}),showCancel:!1,okText:"确认提交",onConfirm:function(){s("submitting"),xt("submit_feedback",{challenge_key:n.key,feedback:r}).then((e=>{e.error?(l.error({content:e.error_msg,key:"Feedback",duration:3}),s("draft")):(l.success({content:"反馈提交成功",key:"Feedback",duration:2}),s("done"))}))},children:Ke.jsxs(u,{block:!0,type:"primary",disabled:!r||"draft"!==t,children:[Ke.jsx(de,{})," ","done"===t?"已":"submitting"===t?"正在":"","提交反馈"]})})]})})}function ms({ch:e,flag:n,show_pass_count:t}){let s,r,a,l;e?(s=e.tot_base_score,r=e.tot_cur_score,a=e.passed_users_count,l=e.touched_users_count):(s=n.base_score,r=n.cur_score,a=n.passed_users_count,l=a);let i,o=0===s?0:100*(1-r/s),c=`基础分值 ${s}，通过人数 ${a}`+(l>a?`，部分通过人数 ${l}`:""),d=Ke.jsxs("span",{className:"item-discount-full",children:["(-",o.toFixed(0),"%) ",Ke.jsx(he,{}),a,l>a?"+":""]});return i=t?0===l?null:Ke.jsxs("span",{className:"item-discount-selected",children:[Ke.jsx(he,{}),a,l>a?"+":""]}):s===r?null:Ke.jsxs("span",{className:"item-discount-selected",children:["(-",o.toFixed(0),"%)"]}),Ke.jsxs("span",{className:"item-discount",title:c,children:[d,i]})}function xs({ch:n,do_reload_list:t}){let s=Ct(),[r,a]=e.useReducer(((e,n)=>e===n?"":n),"");return Ke.jsxs("div",{className:"challenge-body",children:[Ke.jsxs("div",{className:"challenge-titlebox",children:[Ke.jsx("span",{className:"challenge-titlebox-title",children:n.title}),Ke.jsx("span",{className:"challenge-titlebox-key",children:n.key})]}),Ke.jsxs("p",{className:"challenge-stat",children:[Ke.jsxs(T,{color:"default",children:["基础分值 ",n.tot_base_score]}),Ke.jsx("a",{onClick:()=>a("touched_users"),children:Ke.jsxs(T,{color:"default",children:["touched_users"===r?Ke.jsx(se,{}):Ke.jsx(h,{})," ","共 ",n.passed_users_count," 人通过",n.touched_users_count>n.passed_users_count&&Ke.jsxs(Ke.Fragment,{children:["（",n.touched_users_count," 人部分通过）"]})]})}),!!s.feature.submit_flag&&Ke.jsx("a",{onClick:()=>a("feedback"),children:Ke.jsxs(T,{color:"default",children:["feedback"===r?Ke.jsx(se,{}):Ke.jsx(h,{})," ","反馈问题"]})}),!!n.metadata.author&&Ke.jsxs(T,{color:"default",children:["命题人：",n.metadata.author]}),!(!n.metadata.first_blood_award_eligible||"pku"!==s.user.group)&&Ke.jsx(T,{color:"default",children:Ke.jsx("a",{href:"#/board/first_pku",children:Ke.jsxs("b",{children:[Ke.jsx(M,{})," 解题先锋奖"]})})})]}),Ke.jsx("br",{}),Ke.jsxs(as,{cur:r,skipexit:""===r,children:["touched_users"===r&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(cs,{ch:n}),Ke.jsx("br",{})]}),"feedback"===r&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(hs,{ch:n}),Ke.jsx("br",{})]})]}),Ke.jsx(us,{ch:n}),n.status.startsWith("passed")?Ke.jsx(x,{type:"success",showIcon:!0,message:"你已经通过此题"}):s.feature.submit_flag?Ke.jsx(ds,{do_reload_list:t,ch:n},n.key):Ke.jsx(x,{type:"info",showIcon:!0,message:"现在不允许提交 Flag"}),Ke.jsx("br",{}),Ke.jsx(ls,{})]})}function ps({current:n,reloaded:t,reversed:s}){let[r,a]=e.useState(null),[l,i]=e.useState(!1),o=e.useRef({reloaded:t,value:n});e.useEffect((()=>{if(t===o.current.reloaded)return;let e=o.current.value;o.current.value=n,o.current.reloaded=t,a(e),i(!0);let s=setTimeout((()=>{i(!1)}),1500);return()=>{clearTimeout(s)}}),[n,t]);let c=n&&r?n-r:null;if(null===c)return null;let d=0===c?"keep":(s?c<0:c>0)?"up":"down",u=Math.abs(c);return Ke.jsx("span",{className:`trend-mark${l?" trend-mark-active":""} trend-mark-${d}`,children:"up"===d?Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(me,{}),u]}):"down"===d?Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(xe,{}),u]}):"KEEP"})}function js({info:n,last_reloaded:t}){let s=o(),r=n.tot_score_by_cat?n.tot_score_by_cat.filter((e=>"Tutorial"!==e[0])):[];return Ke.jsxs("div",{className:"portal-user-info",onClick:()=>s("/board/"+n.board_key),children:[Ke.jsxs("div",{className:"portal-user-info-status",children:["总分 ",Ke.jsx("b",{children:n.tot_score}),Ke.jsx(ps,{reversed:!1,current:n.tot_score,reloaded:t}),"，",n.board_name," ",Ke.jsxs("b",{children:["#",n.board_rank||"N/A"]}),Ke.jsx(ps,{reversed:!0,current:n.board_rank,reloaded:t})]}),r.length>0&&Ke.jsxs("div",{className:"portal-user-info-cat",children:[Ke.jsx(re,{})," ",r.map(((n,t)=>Ke.jsxs(e.Fragment,{children:[0!==t?" + ":null,n[0]," ",n[1]]},n)))]})]})}function gs({list:n,active_key:t,set_active_key:s}){let[r,a]=e.useState(!1),[l,i]=e.useState(!1);return Ke.jsx("div",{className:"portal-chall-list",children:null===n?Ke.jsx(x,{showIcon:!0,type:"info",message:"现在不允许查看题目"}):Ke.jsxs(Ke.Fragment,{children:[Ke.jsxs("div",{className:"portal-chall-row portal-chall-header",children:[Ke.jsxs("div",{className:"portal-chall-col-title",children:["题目名称",Ke.jsx("span",{className:"portal-chall-mode-switch-btn",onClick:()=>i(!l),children:Ke.jsxs(j,{title:Ke.jsxs(Ke.Fragment,{children:["当前显示：",l?"题目 ID":"题目分类",Ke.jsx("br",{}),"点击切换"]}),children:["(",Ke.jsx(ae,{}),")"]})})]}),Ke.jsxs("div",{className:"portal-chall-col-score",children:["分值",Ke.jsx("span",{className:"portal-chall-mode-switch-btn",onClick:()=>a(!r),children:Ke.jsxs(j,{title:Ke.jsxs(Ke.Fragment,{children:["当前显示：",r?"总通过人数":"动态分值系数",Ke.jsx("br",{}),"点击切换"]}),children:["(",Ke.jsx(ae,{}),")"]})})]})]}),n.map((n=>Ke.jsxs(e.Fragment,{children:[Ke.jsxs("div",{className:"portal-chall-row"+(t===n.key?" portal-chall-row-active":""),onClick:()=>s(n.key),children:[Ke.jsxs("div",{className:"portal-chall-col-title",children:[l?Ke.jsx("span",{style:{color:n.category_color},className:"portal-chall-col-key",children:n.key}):Ke.jsx(It,{color:n.category_color,children:n.category}),Ke.jsx(St,{status:n.status})," ",n.title,n.flags.length>1&&Ke.jsx("span",{className:"portal-chall-caret",children:Ke.jsx(h,{})})]}),Ke.jsxs("div",{className:"portal-chall-col-score",children:[n.tot_cur_score,Ke.jsx("span",{className:"label-for-score",children:"分"})," ",Ke.jsx(ms,{ch:n,show_pass_count:r})]})]}),t===n.key&&n.flags.length>1&&n.flags.map(((e,n)=>Ke.jsxs("div",{className:"portal-chall-row portal-chall-row-active portal-chall-row-flag",children:[Ke.jsxs("div",{className:"portal-chall-col-title",children:[Ke.jsx(At,{status:e.status})," ",e.name]}),Ke.jsxs("div",{className:"portal-chall-col-score",children:[e.cur_score,Ke.jsx("span",{className:"label-for-score",children:"分"})," ",Ke.jsx(ms,{flag:e,show_pass_count:r})]})]},n)))]},n.key))),0===n.length&&Ke.jsx(Q,{image:Q.PRESENTED_IMAGE_SIMPLE,description:"暂无题目"})]})})}function fs({error_msg:n,splash_msg:t}){let[s,r]=e.useState(!0),a=o();return Ke.jsxs("div",{className:"slim-container",children:[Ke.jsx(x,{type:"error",message:n,showIcon:!0}),!0===s&&Ke.jsxs("div",{className:"banned-splash",children:[Ke.jsx("div",{children:Ke.jsx(ut,{})}),Ke.jsx("h1",{children:"你号没了"}),Ke.jsx("p",{children:t}),Ke.jsxs("div",{children:[Ke.jsx(u,{type:"text",danger:!0,size:"large",onClick:()=>a("/info/announcements"),children:"查看比赛公告"})," ",Ke.jsx(u,{type:"text",danger:!0,size:"large",onClick:()=>r(!1),children:"知道了"})]})]}),Ke.jsx("br",{}),Ke.jsx(ns,{name:"game"})]})}function bs(){let[n,t,s]=pt("game"),{info:r,reload_info:a}=e.useContext(vt),l=o(),[i,c,d]=xn(s,3,180),{challenge:h}=X(),{message:p}=m.useApp();e.useEffect((()=>{t&&r.cur_tick!==t.cur_tick&&a()}),[r,t]),h=h||null;let j=r.user?h:null,g=e.useMemo((()=>{if(null!==t&&null!==t.challenge_list)for(let e of t.challenge_list)if(e.key===j)return e;return null}),[t,j]);return e.useEffect((()=>{ct()}),[j]),e.useEffect((()=>{function e(){ct()}return window.addEventListener("focus",e),()=>{window.removeEventListener("focus",e)}}),[]),e.useEffect((()=>{n&&("SHOULD_AGREE_TERMS"===n.error&&(p.info({content:n.error_msg,key:"Portal.Error",duration:2}),l("/user/terms")),"SHOULD_UPDATE_PROFILE"===n.error&&(p.info({content:n.error_msg,key:"Portal.Error",duration:2}),l("/user/profile")))}),[n,l]),"try-try-jiu-die-die"===h?Ke.jsx(fs,{error_msg:"欸，就是玩~",splash_msg:"其实你号还在，但总有人想体验这种别样的乐趣。不是吗？"}):n?"USER_BANNED"===n.error?Ke.jsx(fs,{error_msg:n.error_msg,splash_msg:it}):Ke.jsx("div",{className:"slim-container",children:Ke.jsx(bt,{message:n.error_msg,reload:()=>{c()}})}):Ke.jsxs("div",{className:"portal-container",children:[Ke.jsxs("div",{className:"portal-sidebar",children:[Ke.jsxs("div",{className:"portal-headline",children:[Ke.jsxs("div",{children:[Ke.jsx(R,{})," ",0!==i&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(un,{ts:i}),"更新"]})]}),Ke.jsx("div",{children:Ke.jsxs(u,{type:"link",ref:d,onClick:()=>{p.success({content:"已刷新题目数据",key:"Portal.ManualLoadData",duration:2}),c()},children:[Ke.jsx(O,{})," 刷新题目"]})})]}),null===t?Ke.jsx(jt,{}):Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("div",{className:"portal-primary-btn",children:t.show_writeup?Ke.jsxs(u,{block:!0,size:"large",onClick:()=>l("/writeup"),type:"primary",children:[Ke.jsx(ee,{})," 提交 Writeup"]}):null===r.user?Ke.jsx(x,{type:"info",showIcon:!0,message:"比赛进行中，报名参赛方可查看题目"}):Ke.jsxs(u,{block:!0,size:"large",onClick:()=>l("/info/faq"),children:[Ke.jsx(ne,{})," 选手常见问题"]})}),null!==t.user_info&&Ke.jsx(js,{info:t.user_info,last_reloaded:i}),Ke.jsx(gs,{list:t.challenge_list,active_key:h,set_active_key:e=>{r.user?function(e){l("/game/"+e)}(e):p.info({content:"报名参赛方可查看题目",key:"Portal.GotoChallenge",duration:2})}})]})]}),Ke.jsxs("div",{className:"portal-main",children:[null!==t&&null!==t.trigger&&Ke.jsxs("div",{className:"portal-headline",children:[Ke.jsxs("div",{children:[Ke.jsx(w,{})," ",t.trigger.current_name.replace(/;/,"，"),!!t.trigger.next_name&&Ke.jsxs(Ke.Fragment,{children:["（",Ke.jsx(un,{ts:t.trigger.next_timestamp_s,delta:5}),"：",t.trigger.next_name.replace(/;/,"，"),"）"]})]}),Ke.jsx("div",{children:Ke.jsxs(u,{type:"link",onClick:()=>{window.location.href="#/info/triggers"},children:[Ke.jsx(te,{})," 查看赛程安排"]})})]}),null!==t&&null!==t.last_announcement&&Ke.jsx(ss,{announcement:t.last_announcement,extra:Ke.jsxs("a",{href:"#/info/announcements",children:[Ke.jsx(te,{})," 查看所有公告"]})}),Ke.jsx(as,{cur:j,children:null!==g?Ke.jsx(xs,{ch:g,do_reload_list:()=>{window.scroll(0,0),c()}}):null!==j&&null!==t?Ke.jsx(hn,{}):Ke.jsxs(Ke.Fragment,{children:[Ke.jsx(ns,{name:"game"}),null===r.user&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("br",{}),Ke.jsx(is,{})]})]})})]})]})}function ys(){return Ct().feature.game?Ke.jsx(bs,{}):Ke.jsxs("div",{className:"slim-container",children:[Ke.jsx(ns,{name:"game"}),Ke.jsx("br",{}),Ke.jsx(is,{})]})}function ws({status:e,children:n}){return Ke.jsx("span",{className:`trigger-status-${e}`,children:n})}function ks({children:e}){let n=e.split(";");return Ke.jsx("div",{className:"trigger-fragments",children:n.map(((e,n)=>Ke.jsx("p",{children:e},n)))})}function _s(){let[e,n,t]=pt("triggers");return e?Ke.jsx(bt,{message:e.error_msg,reload:t}):null===n?Ke.jsx(jt,{}):Ke.jsxs("div",{children:[Ke.jsx("br",{}),Ke.jsx(ge,{mode:"left",items:n.list.map((e=>({color:{pst:"gray",prs:"blue",ftr:"black"}[e.status],dot:{pst:null,prs:Ke.jsx(fe,{}),ftr:null}[e.status],label:Ke.jsx(ws,{status:e.status,children:0===e.timestamp_s?"--":on(e.timestamp_s,!1)}),children:Ke.jsx(ws,{status:e.status,children:Ke.jsx(ks,{children:e.name})})})))}),0===n.list.length&&Ke.jsx(Q,{image:Q.PRESENTED_IMAGE_SIMPLE,description:"暂无赛程"})]})}const vs=new Set(["w","m","@","%","~","=","<",">","&"]);for(let Gs="A".charCodeAt(0),Qs="Z".charCodeAt(0);Gs<=Qs;Gs++)vs.add(String.fromCharCode(Gs));function Es(e){return(Intl.Segmenter?Array.from((new Intl.Segmenter).segment(e)).map((e=>e.segment)):[...e]).map((e=>1===e.length&&e.charCodeAt(0)<128&&!vs.has(e)?1:2)).reduce(((e,n)=>e+n),0)}function Cs(){let{info:n,reload_info:t}=e.useContext(vt),[s,r]=e.useState(!1),a=e.useRef(null),l=o(),{message:i}=m.useApp();if(!n.user)return Ke.jsx(x,{type:"error",showIcon:!0,message:"未登录",description:"请登录后修改个人资料"});let c={colon:!1,initialValues:n.user.profile,labelCol:{span:6},labelWrap:!0,wrapperCol:{span:13},onValuesChange:()=>{r(!0)}},d={size:"small",type:"inner",bordered:!1},h={onPressEnter:()=>{a.current&&a.current.click()}};return Ke.jsxs(W.Provider,{onFormFinish:(e,{forms:n})=>{if("submit"!==e)return;if(!s)return;let r={};Object.values(n).forEach((e=>{Object.assign(r,e.getFieldsValue())})),i.loading({content:"正在保存…",key:"UserProfile",duration:10}),xt("update_profile",{profile:r}).then((e=>{e.error?(i.error({content:e.error_msg,key:"UserProfile",duration:3}),"SHOULD_AGREE_TERMS"===e.error&&l("/user/terms")):(i.success({content:"保存成功",key:"UserProfile",duration:2}),t(),l("/"))}))},children:[Ke.jsxs(_,{title:"公开资料",...d,children:[Ke.jsxs(W,{name:"public",...c,children:[void 0!==n.user.profile.nickname&&Ke.jsx(W.Item,{name:"nickname",label:"昵称",extra:"如包含不适宜内容可能会被强制修改、封禁账号或追究责任",children:Ke.jsx(le,{count:{show:!0,max:40,strategy:Es},placeholder:"（将显示在排行榜上）",...h})}),void 0!==n.user.profile.gender&&Ke.jsx(W.Item,{name:"gender",label:"性别",children:Ke.jsxs(H.Group,{buttonStyle:"solid",children:[Ke.jsx(H.Button,{value:"male",children:"男"}),Ke.jsx(H.Button,{value:"female",children:"女"}),Ke.jsx(H.Button,{value:"other",children:"其他"})]})}),Ke.jsxs(W.Item,{label:"用户组",extra:`UID: #${n.user.id}`,children:[Ke.jsx(Rt,{children:n.user.group_disp}),Ke.jsx(Ft,{badges:n.user.badges})]})]}),"banned"===n.user.group&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("br",{}),Ke.jsx(x,{type:"error",showIcon:!0,message:it})]}),"other"===n.user.group&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("br",{}),Ke.jsx(x,{type:"info",showIcon:!0,message:"你的身份不是两校在校学生，将不参与评奖。如有疑问请联系工作人员。"})]})]}),Ke.jsx("br",{}),Ke.jsxs(_,{title:"联系方式",...d,children:[Ke.jsxs(W,{name:"contact",...c,children:[void 0!==n.user.profile.tel&&Ke.jsx(W.Item,{name:"tel",label:"电话号码",children:Ke.jsx(le,{maxLength:20,...h})}),void 0!==n.user.profile.email&&Ke.jsx(W.Item,{name:"email",label:"邮箱",children:Ke.jsx(le,{...h,placeholder:"请填写清华邮箱地址"})}),void 0!==n.user.profile.stuid&&Ke.jsx(W.Item,{name:"stuid",label:"学号",children:Ke.jsx(le,{...h})}),void 0!==n.user.profile.qq&&Ke.jsx(W.Item,{name:"qq",label:"QQ号",children:Ke.jsx(le,{maxLength:50,...h})})]}),["pku","thu"].includes(n.user.group)&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("br",{}),Ke.jsx(x,{type:"info",showIcon:!0,message:Ke.jsxs(Ke.Fragment,{children:["请正确填写以便赛后联系和颁奖，同时请加入选手 QQ 群 ",st]})})]})]}),Ke.jsx("br",{}),Ke.jsx(_,{title:"其他信息",...d,children:Ke.jsxs(W,{name:"other",...c,children:[void 0!==n.user.profile.comment&&Ke.jsx(W.Item,{name:"comment",label:"了解比赛的渠道",extra:"用于调研宣传效果",children:Ke.jsx(le,{maxLength:100,placeholder:"（可不填）",...h})}),Ke.jsx(W.Item,{label:"登录方式",children:Ke.jsx("span",{className:"ant-form-text",children:n.user.login_key})})]})}),Ke.jsx("br",{}),Ke.jsx(W,{name:"submit",children:Ke.jsxs(u,{type:"primary",size:"large",block:!0,htmlType:"submit",disabled:!s,ref:a,children:[Ke.jsx(be,{})," 保存"]})})]})}function Ns(){return Ke.jsxs("div",{className:"slim-container user-profile-container",children:[Ke.jsx("h1",{children:"个人资料"}),Ke.jsx(Cs,{})]})}function Ts(){let{info:n,reload_info:t}=e.useContext(vt),s=o(),{message:r}=m.useApp();return Ke.jsxs("div",{className:"slim-container",children:[Ke.jsx("h1",{children:"参赛须知"}),Ke.jsx(ns,{name:"terms"}),Ke.jsx("br",{}),null!==n.user&&(n.user.terms_agreed?Ke.jsxs(u,{type:"primary",size:"large",block:!0,disabled:!0,children:[Ke.jsx(be,{})," 已同意参赛须知"]}):Ke.jsxs(u,{type:"primary",size:"large",block:!0,onClick:function(){r.loading({content:"正在保存…",key:"Terms",duration:10}),ct(),xt("agree_term",{}).then((e=>{e.error?r.error({content:e.error_msg,key:"Terms",duration:3}):(r.success({content:"保存成功",key:"Terms",duration:2}),t(),s("/"))}))},children:[Ke.jsx(be,{})," 我理解并同意参赛须知"]}))]})}function Ss(){let{message:e}=m.useApp();return Ke.jsxs("div",{className:"slim-container",children:[Ke.jsx(x,{showIcon:!0,message:Ke.jsx("b",{children:"校外选手注意事项"}),description:Ke.jsxs(Ke.Fragment,{children:[Ke.jsx("p",{children:"我们允许校外选手通过 OAuth 登录一同参与比赛。 校外选手不参与评奖，但可以正常解答题目，分数会出现在总排行榜上。 我们将为成绩优秀的校外选手颁发成绩证明和纪念品。"}),Ke.jsx("p",{children:"校外选手答题将不影响动态分值机制，即题目分数只受校内解出人数影响。"}),Ke.jsxs("p",{children:["校外选手同样需要遵守 ",Ke.jsx("a",{href:"#/user/terms",children:"诚信比赛须知"}),"，在比赛结束前不得公布解法或提示，不得代打或与他人合作。"]}),Ke.jsx("p",{children:"在解题时请遵守法律法规，仅可攻击题目指定的主机。 如果选手在解题时非法访问或破坏了其他无关系统，将承担相应的法律责任。"})]})}),Ke.jsx("br",{}),Ke.jsxs("div",{className:"login-instruction",children:[Ke.jsx("p",{children:Ke.jsx("b",{children:"选择登录方式"})}),Ke.jsxs("p",{children:[Ke.jsxs(u,{size:"large",onClick:()=>an("github/login",e),children:[Ke.jsx(ye,{})," GitHub"]})," ",Ke.jsxs(u,{size:"large",onClick:()=>an("microsoft/login",e),children:[Ke.jsx(we,{})," Microsoft"]})]}),Ke.jsx("br",{}),Ke.jsx("hr",{}),Ke.jsx("br",{}),Ke.jsx("p",{className:"login-iaaa-warning",children:Ke.jsx("b",{children:"校内选手注意"})}),Ke.jsx("p",{children:"本竞赛不允许选手注册多个账号，北京大学和清华大学选手务必全程通过校内统一身份认证系统登录，否则将会失去评奖资格。"}),Ke.jsxs("p",{children:[Ke.jsxs(u,{size:"large",onClick:()=>an("pku/redirect",e),children:[Ke.jsx(Z,{})," 北京大学登录"]})," ",Ke.jsxs(u,{size:"large",onClick:()=>an("carsi/login",e),children:[Ke.jsx(Z,{})," 清华大学登录"]})]})]})]})}let As=!1;function Is(){let n=Ct(),t=i(),s=o(),{message:r}=m.useApp(),a=t.pathname.startsWith("/user/")?t.pathname:"/"+t.pathname.substring(1).split("/")[0],l="all";return n.user&&("pku"===n.user.group?l="pku":"thu"===n.user.group&&(l="thu")),e.useEffect((()=>{As||"/board"!==a||(As=!0,Mt(),Ot())}),[a]),Ke.jsx("div",{className:"header-container",children:Ke.jsxs("div",{className:"header",children:[Ke.jsx("div",{className:"header-logo",children:Ke.jsxs("span",{className:"clickable",onClick:()=>s("/game"),children:[Ke.jsx(ut,{cur_url:a}),tt]})}),Ke.jsx("div",{className:"header-nav",children:Ke.jsx(ke,{mode:"horizontal",theme:"dark",selectedKeys:[a],onSelect:e=>{"_"!==e.key.charAt(0)&&s(e.key+(e.item.props.default_subview||""))},items:[...n.feature.game&&n.user?[{key:"/game",icon:Ke.jsx(_e,{}),label:"比赛主页"}]:[],{key:"/board",default_subview:"/score_"+l,icon:Ke.jsx(ve,{}),label:"排行榜"},...n.user?[{key:"_/user",icon:Ke.jsx(he,{}),label:Ke.jsx(pn,{children:Ke.jsx(rn,{text:n.user.profile.nickname||"账户",width:110})}),popupClassName:"header-nav-popup",popupOffset:[-6,2],children:[{key:"/user/submissions",icon:Ke.jsx(R,{}),label:"提交历史记录"}]}]:[{key:"_/login",icon:Ke.jsx(Te,{}),label:Ke.jsx(pn,{children:"参赛"}),className:"header-nav-login",popupClassName:"header-nav-popup",popupOffset:[-6,2],children:[{key:"_/login/pku",icon:Ke.jsx(Z,{}),label:"北京大学登录",onClick:()=>an("pku/redirect",r)},{key:"_/login/thu",icon:Ke.jsx(Z,{}),label:"清华大学登录",onClick:()=>an("carsi/login",r)},{key:"/login/other",icon:Ke.jsx(V,{}),label:"校外选手"}]}]]})})]})})}var Fs={VITE_APP_BUILD_INFO:"2410111636",VITE_APP_ANTICHEAT_ENABLED:"true",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function Ps(){let e=Ct(),n=e?e.diag_ts:0;return Ke.jsxs("div",{className:"footer",children:[Math.abs(n)>12e4&&Ke.jsxs(Ke.Fragment,{children:[Ke.jsxs("p",{className:"footer-warning",children:["你的本地时间在服务器时间的",Ke.jsx(dn,{date:n,live:!1,now:()=>0,title:`${Math.round(n/1e3)} 秒`})]}),Ke.jsx("p",{className:"footer-warning",children:"时间显示可能不准确，请核对后刷新页面"})]}),Ke.jsxs("p",{children:["Project ",Ke.jsx("b",{children:"Guiding Star"})," by PKUGGG Team"," (2410111636)",Fs.VITE_APP_MOCK_API_ENV?" (Mock: "+Fs.VITE_APP_MOCK_API_ENV+")":null]}),Ke.jsx("p",{children:Ke.jsxs("a",{href:"#/license",children:[Ke.jsx(ye,{})," 开放源代码"]})})]})}function Rs(){let{page:e}=X(),n=o(),t=Ct(),s=Ae();return Ke.jsxs("div",{className:"slim-container",children:[Ke.jsx(ke,{className:"router-menu",mode:"horizontal",selectedKeys:[e],onSelect:e=>{n(`/info/${e.key}`)},items:[{key:"announcements",icon:Ke.jsx(y,{}),label:"比赛公告"},{key:"triggers",icon:Ke.jsx(w,{}),label:"赛程安排"},...t.feature.templates.map((([e,n])=>({key:e,icon:Ke.jsx(ne,{}),label:n})))]}),Ke.jsx("br",{}),Ke.jsx(as,{cur:e,children:s})]})}function Os(){let{page:e}=X();return"announcements"===e?Ke.jsx(rs,{}):"triggers"===e?Ke.jsx(_s,{}):Ke.jsx(ns,{name:e})}function Ds(){let{name:e}=X(),n=Ae(),t=o();return Ke.jsxs("div",{children:[Ke.jsx(ke,{className:"router-menu",mode:"horizontal",selectedKeys:[e],onSelect:e=>{t(`/board/${e.key}`)},items:[{key:"_pku",icon:Ke.jsx(Z,{}),label:Ke.jsx(pn,{children:"北京大学赛道"}),children:[{key:"score_pku",icon:Ke.jsx(Ie,{}),label:"排名"},{key:"first_pku",icon:Ke.jsx(Fe,{}),label:"一血榜"}]},{key:"_thu",icon:Ke.jsx(Z,{}),label:Ke.jsx(pn,{children:"清华大学赛道"}),children:[{key:"score_thu",icon:Ke.jsx(Ie,{}),label:"排名"},{key:"first_thu",icon:Ke.jsx(Fe,{}),label:"一血榜"}]},{key:"_other",icon:Ke.jsx(V,{}),label:Ke.jsx(pn,{children:"其他选手"}),children:[{key:"score_other",icon:Ke.jsx(Ie,{}),label:"排名"},{key:"first_other",icon:Ke.jsx(Fe,{}),label:"一血榜"}]},{key:"_all",icon:Ke.jsx(ve,{}),label:Ke.jsx(pn,{children:"所有选手"}),children:[{key:"score_all",icon:Ke.jsx(Ie,{}),label:"排名"},{key:"first_all",icon:Ke.jsx(Fe,{}),label:"一血榜"}]}]}),Ke.jsx(as,{cur:e,children:n})]})}function Ls(){let{name:e}=X();return Ke.jsx(Zt,{name:e},e)}function Ms(){let n=Ct();return e.useEffect((()=>{if(n.user&&n.user.terms_agreed)return window.addEventListener("focus",e),window.addEventListener("blur",t),document.addEventListener("paste",s),()=>{window.removeEventListener("focus",e),window.removeEventListener("blur",t),document.removeEventListener("paste",s)};function e(){fetch(`${et}event?name=focus&tabid=${mt}`,{method:"GET",credentials:"include",priority:"low"})}function t(){fetch(`${et}event?name=blur&tabid=${mt}`,{method:"GET",credentials:"include",priority:"low"})}function s(e){let n={};e.clipboardData.types.forEach((t=>{let s=e.clipboardData.getData(t);n[t]=s.slice(0,2048)})),fetch(`${et}event?name=paste&tabid=${mt}`,{method:"GET",credentials:"include",priority:"low",headers:{"Content-Type":"application/json"}})}}),[n.user]),null}function Ws(){let{pathname:e}=i(),n=Ae(),t=e.startsWith("/user")?e:e.split("/")[1];return Ke.jsxs("div",{children:[Ke.jsx(Ms,{}),Ke.jsx(Is,{}),Ke.jsx("div",{className:"main-container",children:Ke.jsx(as,{cur:t,children:Ke.jsx(x.ErrorBoundary,{children:n})})}),Ke.jsx(Ps,{})]})}function Bs(){let e=Ct(),n="all";return e.user&&("pku"===e.user.group?n="pku":"thu"===e.user.group&&(n="thu")),Ke.jsx(Se,{to:"/board/score_"+n,replace:!0})}const zs=[{element:Ke.jsx(Ws,{}),children:[{path:"/",element:Ke.jsx(Se,{to:"/game",replace:!0})},{path:"/game/:challenge?",element:Ke.jsx(ys,{})},{path:"/board",element:Ke.jsx(Ds,{}),children:[{index:!0,element:Ke.jsx(Bs,{})},{path:":name",element:Ke.jsx(Ls,{})}]},{path:"/info",element:Ke.jsx(Rs,{}),children:[{index:!0,element:Ke.jsx(Se,{to:"/info/announcements",replace:!0})},{path:":page",element:Ke.jsx(Os,{})}]},{path:"/user",children:[{path:"profile",element:Ke.jsx(Ns,{})},{path:"submissions",element:Ke.jsx(Ht,{})},{path:"terms",element:Ke.jsx(Ts,{})}]},{path:"/login/other",element:Ke.jsx(Ss,{})},{path:"/writeup",element:Ke.jsx(Xt,{})},{path:"/license",element:Ke.jsx(Nt,{})},{path:"*",element:Ke.jsx(hn,{})}]}];Element.prototype.replaceChildren||(Element.prototype.replaceChildren=function(...e){this.textContent="",this.append(...e)});let Ys=Pe(zs,{future:{v7_startTransition:!0}}),Hs=Ke.jsx(Re.StrictMode,{children:Ke.jsx(Oe,{button:{autoInsertSpace:!1},locale:tn,theme:{token:{colorPrimary:"#0063cc",colorLink:"#0063cc",colorText:"#000",fontWeightStrong:500,borderRadiusLG:6,motionDurationSlow:"0.2s"},components:{App:{fontSize:16},Table:{rowHoverBg:"#f9f9f9",headerBg:"#f9f9f9",headerBorderRadius:0}}},children:Ke.jsx(De,{hashPriority:"high",transformers:[Le],children:Ke.jsx(x.ErrorBoundary,{children:Ke.jsx(m,{notification:{duration:7,placement:"topRight",maxCount:4,top:70,closeIcon:Ke.jsx(Me,{})},message:{top:1},children:Ke.jsx(Et,{children:Ke.jsx(We,{router:Ys})})})})})})});qe.createRoot(document.getElementById("root")).render(Hs),queueMicrotask(console.log.bind(console,"%c比赛平台不是题目的一部分，解出题目无需攻击比赛平台。\n根据参赛须知，请仅对题目指定的主机（prob*.geekgame.pku.edu.cn）和程序进行攻击。","font-size: 1.5em; background-color: yellow; color: black; font-weight: bold; padding: .5em"));export{on as f,Ke as j,Ct as u};